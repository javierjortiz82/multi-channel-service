# Telegram Bot Configuration
# Get your token from @BotFather on Telegram
TELEGRAM_BOT_TOKEN=your-telegram-bot-token-here

# Webhook Configuration
# Public URL where Telegram will send updates (must be HTTPS in production)
WEBHOOK_HOST=https://your-domain.com
WEBHOOK_PATH=/webhook
# Secret token for webhook verification (generate a secure random string)
WEBHOOK_SECRET=your-secure-webhook-secret
# Maximum simultaneous HTTPS connections for update delivery (1-100)
# Higher values = more concurrent updates, but more resource usage
WEBHOOK_MAX_CONNECTIONS=100
# Enable IP filtering to allow only Telegram servers
# IPv4: 149.154.160.0/20, 91.108.4.0/22
# IPv6: 2001:67c:4e8::/48, 2001:b28:f23d::/48, 2001:b28:f23f::/48
# Disable only if behind a proxy that strips IPs (use proxy-level filtering instead)
WEBHOOK_IP_FILTER_ENABLED=true
# Drop pending updates when setting webhook (recommended for fresh starts)
WEBHOOK_DROP_PENDING_UPDATES=true

# Server Configuration
SERVER_HOST=0.0.0.0
SERVER_PORT=8002

# Application Configuration
# Options: development, staging, production
ENVIRONMENT=development
# Options: DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_LEVEL=INFO
DEBUG=false

# Concurrency Configuration
# Number of uvicorn workers (1-32, recommended: 2 * CPU cores + 1)
WORKERS=4
# Maximum concurrent connections per worker (1-10000)
# Prevents memory exhaustion under heavy load by returning HTTP 503
LIMIT_CONCURRENCY=100
# Maximum requests per worker before restart (0=unlimited)
# Helps prevent memory leaks in long-running processes
LIMIT_MAX_REQUESTS=10000
# Maximum connections in backlog queue (1-65535)
# Increase for high traffic scenarios
BACKLOG=2048

# Timeout Configuration
# Seconds to keep idle connections open (1-300)
# Higher values reduce connection overhead but consume more resources
TIMEOUT_KEEP_ALIVE=5
# Seconds to wait for graceful shutdown (1-300)
# Allows in-flight requests to complete before termination
TIMEOUT_GRACEFUL_SHUTDOWN=30

# Performance Configuration
# HTTP protocol implementation: auto, h11, httptools
# httptools is faster but requires compilation (auto selects best available)
HTTP_IMPLEMENTATION=auto
# Event loop implementation: auto, asyncio, uvloop
# uvloop is faster on Linux (auto selects best available)
LOOP_IMPLEMENTATION=auto

# Logging Configuration
# Whether to write logs to file (true/false)
LOG_TO_FILE=true
# Directory for log files (relative or absolute path)
LOG_DIR=./logs
# Maximum log file size in megabytes before rotation (1-100)
LOG_MAX_SIZE_MB=10
# Number of backup log files to keep (1-20)
LOG_BACKUP_COUNT=5

# Webhook Retry Configuration
# Maximum retries for webhook setup on Telegram flood control (1-10)
WEBHOOK_MAX_RETRIES=3
# Buffer time in seconds added to Telegram's retry_after response (0.0-5.0)
WEBHOOK_RETRY_BUFFER_SECONDS=0.5

# Rate Limiting Configuration
# Maximum requests per IP within the rate limit window (10-10000)
# Prevents abuse and DoS attacks on the webhook endpoint
RATE_LIMIT_REQUESTS=100
# Rate limit window in seconds (10-3600)
RATE_LIMIT_WINDOW_SECONDS=60
